<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java TSP</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .code-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin: 20px 0;
        }
        
        h1 {
            color: #333;
            text-align: center;
        }
        
        .code-title {
            background-color: #2d3748;
            color: white;
            padding: 10px 20px;
            margin: 0 0 10px 0;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
        }
        
        .copy-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 4px;
            margin: 0 0 10px 0;
            transition: background-color 0.3s;
        }
        
        .copy-button:hover {
            background-color: #45a049;
        }
        
        .copy-button.copied {
            background-color: #2196F3;
        }
        
        /* Plain text code styling - no syntax highlighting */
        .plain-code {
            font-family: 'Courier New', Consolas, Monaco, monospace;
            background-color: #f8f8f8;
            border: 1px solid #e1e1e1;
            border-radius: 5px;
            padding: 20px;
            margin: 0;
            overflow-x: auto;
            white-space: pre;
            font-size: 14px;
            line-height: 1.5;
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Java TSP</h1>
    
    <div class="code-container">
        <div class="code-title">Java Code</div>
        <button class="copy-button" onclick="copyCode()">ðŸ“‹ Copy Code</button>
        <pre class="plain-code" id="java-code">import java.util.*;
import java.util.Scanner;

public class TSPDynamicProgramming {
    static int N;
    static int[][] dist;
    static int[][] dp;
    static int[][] parent;
    static final int INF = 1000000000;

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);

        System.out.print("Enter number of cities: ");
        N = sc.nextInt();
        sc.nextLine(); // consume leftover newline

        dist = new int[N][N];
        System.out.println("Enter distance matrix row by row (space separated). No negative numbers, diagonal must be zero:");

        for (int i = 0; i < N; i++) {
            while (true) {
                String line = sc.nextLine();
                String[] parts = line.trim().split("\\s+");
                if (parts.length != N) {
                    System.out.println("You must enter exactly " + N + " numbers. Try again:");
                    continue;
                }

                boolean valid = true;
                for (int j = 0; j < N; j++) {
                    try {
                        int val = Integer.parseInt(parts[j]);
                        if (val < 0) {
                            System.out.println("Distance cannot be negative. Try entering the entire row again:");
                            valid = false;
                            break;
                        }
                        if (i == j && val != 0) {
                            System.out.println("Diagonal elements must be zero. Try entering the entire row again:");
                            valid = false;
                            break;
                        }
                        dist[i][j] = val;
                    } catch (NumberFormatException e) {
                        System.out.println("Invalid input. Try entering the entire row again:");
                        valid = false;
                        break;
                    }
                }
                if (valid) break; // row accepted
            }
        }

        // Initialize DP and parent arrays
        dp = new int[N][1 << N];
        parent = new int[N][1 << N];

        for (int i = 0; i < N; i++) {
            for (int j = 0; j < (1 << N); j++) {
                dp[i][j] = -1;
                parent[i][j] = -1;
            }
        }

        int mask = 1; // starting at city 0, so only city 0 visited
        int ans = tsp(0, mask);

        System.out.println("Minimum cost: " + ans);
        System.out.print("Optimal Path: 0 -> ");
        printPath(0, mask);
        System.out.println("0"); // return to start city
    }

    static int tsp(int pos, int mask) {
        if (mask == (1 << N) - 1) {
            return dist[pos][0]; // return to starting city
        }

        if (dp[pos][mask] != -1) {
            return dp[pos][mask];
        }

        int ans = INF;
        int bestNext = -1;

        for (int city = 0; city < N; city++) {
            if ((mask & (1 << city)) == 0) { // if city not visited
                int newAns = dist[pos][city] + tsp(city, mask | (1 << city));
                if (newAns < ans) {
                    ans = newAns;
                    bestNext = city;
                }
            }
        }
        parent[pos][mask] = bestNext;
        return dp[pos][mask] = ans;
    }

    static void printPath(int pos, int mask) {
        int next = parent[pos][mask];
        if (next == -1) return;
        System.out.print(next + " -> ");
        printPath(next, mask | (1 << next));
    }
}

</pre>
    </div>


    <div class="code-container">
        <div class="code-title">Java Code</div>
        <!-- <button class="copy-button" onclick="copyCode()">ðŸ“‹ Copy Code</button> -->
        <pre class="plain-code" id="java-code">import java.util.*;

            import java.util.*;

public class MatrixChainDP {
    
    // Function to print optimal parenthesization
    static void printOptimalOrder(int i, int j, int[][] K, char[] name) {
        if (i == j) {
            System.out.print(name[i]); // single matrix
            return;
        }
        System.out.print("(");
        printOptimalOrder(i, K[i][j], K, name);
        printOptimalOrder(K[i][j] + 1, j, K, name);
        System.out.print(")");
    }
    
    // Function to validate matrix dimensions
    static boolean validateDimensions(int[] p, int n) {
        for (int i = 0; i <= n; i++) {
            if (p[i] <= 0) {
                System.out.println("Error: All dimensions must be positive!");
                return false;
            }
        }
        return true;
    }
    
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        
        try {
            // Input validation for number of matrices
            System.out.print("Enter number of matrices: ");
            int n = sc.nextInt();
            
            if (n <= 0) {
                System.out.println("Error: Number of matrices must be positive!");
                return;
            }
            
            if (n > 26) {
                System.out.println("Error: Cannot handle more than 26 matrices!");
                return;
            }
            
            // Input matrix dimensions
            int[] p = new int[n + 1];
            System.out.println("Enter matrix dimensions:");
            
            // Get first matrix dimensions
            System.out.print("Matrix A (Matrix 1) - Rows: ");
            p[0] = sc.nextInt();
            System.out.print("Matrix A (Matrix 1) - Columns: ");
            p[1] = sc.nextInt();
            
            // Get remaining matrices dimensions
            for (int i = 1; i < n; i++) {
                char matrixName = (char)('A' + i);
                System.out.print("Matrix " + matrixName + " (Matrix " + (i + 1) + ") - Rows: ");
                int rows = sc.nextInt();
                System.out.print("Matrix " + matrixName + " (Matrix " + (i + 1) + ") - Columns: ");
                p[i + 1] = sc.nextInt();
                
                // Validate matrix multiplication compatibility
                if (p[i] != rows) {
                    System.out.println("Error: Matrix " + (char)('A' + i - 1) + " columns (" + p[i] + 
                                     ") must equal Matrix " + matrixName + " rows (" + rows + ")!");
                    return;
                }
            }
            
            // Validate dimensions
            if (!validateDimensions(p, n)) {
                return;
            }
            
            // Display matrix dimensions for confirmation
            System.out.println("\nMatrix dimensions:");
            for (int i = 0; i < n; i++) {
                System.out.println("Matrix " + (char)('A' + i) + ": " + p[i] + " Ã— " + p[i + 1]);
            }
            
            // DP tables
            int[][] M = new int[n + 1][n + 1]; // cost table
            int[][] K = new int[n + 1][n + 1]; // split table
            
            // Initialize cost table (diagonal elements are 0)
            for (int i = 1; i <= n; i++) {
                M[i][i] = 0;
            }
            
            // L = chain length
            for (int L = 2; L <= n; L++) {
                for (int i = 1; i <= n - L + 1; i++) {
                    int j = i + L - 1;
                    M[i][j] = Integer.MAX_VALUE;
                    
                    for (int k = i; k < j; k++) {
                        // Check for potential overflow
                        long cost = (long)M[i][k] + (long)M[k + 1][j] + (long)p[i - 1] * p[k] * p[j];
                        
                        if (cost > Integer.MAX_VALUE) {
                            System.out.println("Warning: Cost overflow detected! Results may be inaccurate.");
                        }
                        
                        int q = (int)Math.min(cost, Integer.MAX_VALUE);
                        
                        if (q < M[i][j]) {
                            M[i][j] = q;
                            K[i][j] = k;
                        }
                    }
                }
            }
            
            // Print M table
            System.out.println("\nM (cost) table:");
            System.out.print("     ");
            for (int j = 1; j <= n; j++) {
                System.out.printf("%8d", j);
            }
            System.out.println();
            
            for (int i = 1; i <= n; i++) {
                System.out.printf("%3d: ", i);
                for (int j = 1; j <= n; j++) {
                    if (i > j) {
                        System.out.print("       -");
                    } else {
                        System.out.printf("%8d", M[i][j]);
                    }
                }
                System.out.println();
            }
            
            // Print K table
            System.out.println("\nK (split) table:");
            System.out.print("     ");
            for (int j = 1; j <= n; j++) {
                System.out.printf("%6d", j);
            }
            System.out.println();
            
            for (int i = 1; i <= n; i++) {
                System.out.printf("%3d: ", i);
                for (int j = 1; j <= n; j++) {
                    if (i >= j) {
                        System.out.print("     -");
                    } else {
                        System.out.printf("%6d", K[i][j]);
                    }
                }
                System.out.println();
            }
            
            // Results
            System.out.println("\n" + "=".repeat(50));
            System.out.println("RESULTS:");
            System.out.println("=".repeat(50));
            System.out.println("Minimum number of scalar multiplications: " + M[1][n]);
            
            // Optimal parenthesization
            char[] name = new char[n + 1]; // Only allocate what we need
            for (int i = 0; i <= n; i++) {
                name[i] = (char)('A' + i - 1); // A, B, C, etc. (starting from index 1)
            }
            
            System.out.print("Optimal parenthesization: ");
            if (n == 1) {
                System.out.println("A");
            } else {
                printOptimalOrder(1, n, K, name);
                System.out.println();
            }
            
        } catch (InputMismatchException e) {
            System.out.println("Error: Please enter valid integers only!");
        } catch (Exception e) {
            System.out.println("Error: " + e.getMessage());
        } finally {
            sc.close();
        }
    }
}
    </pre>
    </div>
    
    <script>
        function copyCode() {
            const codeElement = document.getElementById('java-code');
            const button = document.querySelector('.copy-button');
            
            // Get the plain text content without HTML formatting
            const codeText = codeElement.textContent || codeElement.innerText;
            
            // Create a temporary textarea to copy the text
            const textarea = document.createElement('textarea');
            textarea.value = codeText;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            
            // Update button to show success
            const originalText = button.innerHTML;
            button.innerHTML = 'âœ… Copied!';
            button.classList.add('copied');
            
            // Reset button after 2 seconds
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('copied');
            }, 2000);
        }
        
        // Alternative modern approach for copying (fallback)
        async function copyCodeModern() {
            const codeElement = document.getElementById('java-code');
            const codeText = codeElement.textContent || codeElement.innerText;
            
            try {
                await navigator.clipboard.writeText(codeText);
                console.log('Code copied successfully');
            } catch (err) {
                console.log('Fallback to old copy method');
                copyCode();
            }
        }
    </script>
</body>
</html>
